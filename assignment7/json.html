<!doctype html>
<html>
<head>
<meta charset="utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script type="text/javascript" src="songlist.json"></script>
<link rel="stylesheet" href="mystyle.css">
<title>JSON Song List</title>
</head>
<body>
    <div id="demo"></div> 
    <div id="raw"></div>

    <!-- <div id="formatted"></div> -->

    <div class="form"> 
        <p>Select a genre to see a list of songs in that genre.</p>
        
        <form>

        <label for="genre">Genre: </label>
        <select name="genre" id="genre">
            <option value="any">any</option>
            <option value="indie">indie</option>
            <option value="r&b">r&b</option>
            <option value="rap">rap</option>
            <option value="pop">pop</option>
            <option value="hip hop">hip hop</option>
            <option value="rock">rock</option>
        </select>

        <input type="button" value="Filter" id="filterButton">
    </form>
</div>

    <div id="filteredList"></div>

<script language="javascript">

    const demoDiv = document.getElementById('demo');
    const newDivElement = document.createElement('div');
    newDivElement.innerHTML = "<h1>Mel's SongList</h1>";
    demoDiv.appendChild(newDivElement);
    
    $.get( "songlist.json", 
         function(data) {
             str = JSON.stringify(data);
             $("#raw").html(str + "<br/>");
             strHTML= "";
             data.forEach(function(song) { 
                strHTML += "<br>" 
                 + song.song + "</br> Artist: "
                 + song.artist + "</br> Genre: "
                 + song.genre + "</br> Released "
                 + song.year + "</br>";
             })
         $("#filteredList").html(strHTML);
        
         $("#filterButton").click(function() {
            var genreSearch = document.getElementById("genre").value;
            var showSongs = "";
            var filterListElem = document.getElementById("filteredList");
            data.forEach(function(songInfo) { 
                if (genreSearch == "any") {
                    showSongs += "<br>"
                    + songInfo.song + "</br> Artist: "
                    + songInfo.artist + "</br> Genre: "
                    + songInfo.genre + "</br> Released "
                    + songInfo.year + "</br>"

                    filterListElem.innerHTML = showSongs;
                }
                else if (songInfo.genre.includes(genreSearch)) {
                    console.log("in if");
                    showSongs += "<br>"
                    + songInfo.song + "</br> Artist: "
                    + songInfo.artist + "</br> Genre: "
                    + songInfo.genre + "</br> Released "
                    + songInfo.year + "</br>"

                    filterListElem.innerHTML = showSongs;
                }
            })
         });
        }
     )

     
 
     </script> 
</body>
</html>